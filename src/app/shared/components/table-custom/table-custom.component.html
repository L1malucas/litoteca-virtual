<div class="project-table">
  <div class="municipio-dropdown">
    <span>PROJETOS ATIVOS</span>
  </div>
  <div class="table-container">
    <div class="table-header">
      <div class="search-filter">
        <div class="filter-option">
          <label for="" class="label">Pavilhao</label>
          <div class="btn-options">
            @for (pavilhao of pavilhoes; track $index) {
              <button
                (click)="selectPavilhao(pavilhao)"
                class="pavilhao"
                [class.active]="selectedPavilhao === pavilhao"
              >
                {{ pavilhao }}
              </button>
            }
          </div>
        </div>

        <div class="filter-option">
          <label for="" class="label">Projetos</label>
          <div class="input-field">
            <input
              type="text"
              placeholder="Selecione ou digite o nome do PROJETO"
              aria-label="Number"
              matInput
              [formControl]="projetoControl"
              [matAutocomplete]="autoProject"
            />
          </div>
          <mat-autocomplete
            #autoProject="matAutocomplete"
            [displayWith]="mostrarNomeProjeto"
            (optionSelected)="onProjectSelected()"
          >
            @for (project of filtroProjetos | async; track $index) {
              <mat-option [value]="project">{{ project.nome }}</mat-option>
            }
          </mat-autocomplete>
        </div>
        <div class="filter-option">
          <label for="" class="label">Alvos</label>
          <div class="input-field">
            <input
              type="text"
              placeholder="Selecione ou digite o nome do Alvo"
              aria-label="Number"
              matInput
              [formControl]="alvoControl"
              [matAutocomplete]="autoAlvos"
              [disabled]="this.alvos.length === 0"
            />
          </div>
          <mat-autocomplete
            #autoAlvos="matAutocomplete"
            [displayWith]="mostrarNomeAlvo"
            (optionSelected)="onAlvoSelected()"
          >
            @for (alvo of filtroAlvos | async; track $index) {
              <mat-option [value]="alvo">{{ alvo.nome }}</mat-option>
            }
          </mat-autocomplete>
        </div>

        <div class="filter-option">
          <label for="projeto" class="label">Furo</label>
          <div class="input-field">
            <input
              type="text"
              placeholder="Selecione ou digite o nome do Alvo"
              aria-label="Alvo"
              matInput
              [formControl]="alvoControl"
              [matAutocomplete]="autoFuro"
              [disabled]="true"
            />
          </div>
          <mat-autocomplete
            #autoFuro="matAutocomplete"
            [displayWith]="mostrarNomeFuro"
            (optionSelected)="onFuroSelected()"
          >
            <mat-option
              *ngFor="let furo of filtroFuros | async; track: $index"
              [value]="furo.id"
            >
              {{ furo.nome }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
      @for (project of filteredProjects; track $index) {
        @for (alvo of project.alvos; track $index) {
          @for (furo of alvo.furos; track $index) {
            <div class="table-body">
              <div>1</div>
              <div>{{ project.nome }}</div>
              <div>{{ alvo.nome }}</div>
              <div>{{ furo.nome }}</div>
              <div class="actions">
                <button mat-icon-button class="action-btn document">
                  <mat-icon>description</mat-icon>
                </button>
                <button
                  mat-icon-button
                  class="action-btn image"
                  (click)="goToGalery(project, alvo, furo)"
                >
                  <mat-icon>image</mat-icon>
                </button>
                <button mat-icon-button class="action-btn location">
                  <mat-icon>location_on</mat-icon>
                </button>
              </div>
            </div>
          }
        }
      }
    </div>
  </div>
</div>
